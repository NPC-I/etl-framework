# ============================================
# ETL Framework Security Configuration
# ============================================
#
# Copy this file to .env.security and update values
# This file should NOT be committed to version control

# SECURITY CONFIGURATION
# ----------------------
ETL_SECURITY_LEVEL=production  # development, testing, staging, production
ETL_ENCRYPTION_ENABLED=true
ETL_ENCRYPTION_KEY=your-secure-encryption-key-here-change-in-production

# ACCESS CONTROL
# --------------
ETL_RBAC_ENABLED=true
# Format: username:role1,role2;username2:role3
ETL_USERS=admin:admin;operator:operator;viewer:viewer;auditor:auditor
ETL_SESSION_TIMEOUT=60  # minutes

# AUDIT LOGGING
# -------------
ETL_AUDIT_LOGGING_ENABLED=true
ETL_AUDIT_LOG_FILE=./logs/audit.log
ETL_AUDIT_RETENTION_DAYS=365
ETL_LOG_SENSITIVE_OPERATIONS=false

# INPUT VALIDATION
# ----------------
ETL_MAX_FILE_SIZE_MB=100
ETL_MAX_JSON_DEPTH=10
ETL_MAX_CALCULATIONS=50

# NETWORK SECURITY
# ----------------
ETL_ALLOW_INSECURE_CONNECTIONS=false
ETL_REQUIRE_TLS=true
# Comma-separated list of allowed IP ranges
ETL_ALLOWED_IP_RANGES=192.168.1.0/24,10.0.0.0/8

# SECURITY SCANNING
# -----------------
ETL_SECURITY_SCAN_INTERVAL=86400  # 24 hours in seconds
ETL_VULNERABILITY_ALERT_EMAIL=security@example.com

# DATABASE SECURITY
# -----------------
# Use environment variables for database credentials
# Example for PostgreSQL:
# ETL_DB_HOST=localhost
# ETL_DB_PORT=5432
# ETL_DB_NAME=etl_database
# ETL_DB_USER=etl_user
# ETL_DB_PASSWORD=secure-password-here

# FILE PERMISSIONS
# ----------------
ETL_FILE_UMASK=0077  # Restrict file permissions
ETL_DIRECTORY_UMASK=0077  # Restrict directory permissions

# LOGGING SECURITY
# ----------------
ETL_LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR
ETL_LOG_SENSITIVE_DATA=false  # Never log passwords or secrets

# RATE LIMITING
# -------------
ETL_RATE_LIMIT_REQUESTS=100  # requests per minute
ETL_RATE_LIMIT_WINDOW=60  # seconds

# BACKUP SECURITY
# ---------------
ETL_BACKUP_ENCRYPTION=true
ETL_BACKUP_RETENTION_DAYS=30
ETL_BACKUP_LOCATION=/secure/backup/location

# MONITORING
# ----------
ETL_MONITORING_ENABLED=true
ETL_ALERT_ON_SECURITY_EVENTS=true
ETL_SECURITY_TEAM_EMAIL=security-alerts@example.com

# ============================================
# IMPORTANT SECURITY NOTES
# ============================================
#
# 1. NEVER commit this file or any .env file to version control
# 2. Use different encryption keys for different environments
# 3. Rotate encryption keys regularly (every 90 days recommended)
# 4. Use strong, randomly generated passwords
# 5. Restrict file permissions on configuration files
# 6. Monitor audit logs regularly
# 7. Keep dependencies updated with security patches
# 8. Conduct regular security reviews and penetration testing
# 9. Follow principle of least privilege for user accounts
# 10. Encrypt sensitive data at rest and in transit